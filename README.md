## 任务背景
这是一个PCB自动布局布线任务，我们的任务是设计一种PCB自动布局布线算法，构建PCB自动布局布线大模型，
将器件的位置信息和器件pin脚之间的布线信息融入大语言模型的token中， 通过生成token的方式来决策器
件的布局结果以及布线结果
## 任务技术方案
1. 数据集准备：一份数据集需要包含一个主器件和若干子器件；需要固定PCB板子的大小，在同一个PCB板子
   上进行布局布线；需要包含主器件的轮廓、 位置信息以及pin脚信息，主器件的位置要固定，调整子器件 
   的位置进行布局；需要包含子器件的个数、轮廓、位置和pin脚信息； 需要包含pin脚连接信息，pin脚
   连接信息为主器件和子器件的pin脚的连接关系的信息，布局时需要根据pin脚连接关系将器件摆放到合理
   的位置， 布线时需要按照pin脚连接关系来进行布线。
2. 大模型部署：采用decoder-only架构的Transformer
3. 编码表：整个工程采用同一套编码表，前10个编码为SOS、EOS、分隔符等特殊编码，PCB板子大小的编码，
   器件的大小编码，布线的走线方向信息编码。
4. 输入到模型的数据结构：<SOS><SOBS><PCB板子的轮廓大小><主器件轮廓大小><主器件左下角的位置编码><EOBS><SEP><SONS>
   <第一个net主器件pin脚的位置编码><第一个net子器件的轮廓大小><SEPN><第二个net主器件pin脚的位置编码>
   <第二个net子器件的轮廓大小>...<EONS><SEP><SODPS><第一个net的布线路径信息><第一个net子器件的左下角的位置编码>
   <SEPDP><第二个net的布线路径信息><第二个net子器件的左下角的位置编码>...<EODPS><EOS><PAD>
## 具体细节
1. PCB板子信息：PCB板子大小为30x30，主器件大小小于等于10x10，子器件大小小于等于2x2
   按照30x30的网格对布局布线环节进行建模，主器件和子器件的轮廓必须位于网格线上
2. 布线的方向信息：布线的线形，即走向有八个，分别为左、右、上、下、左上、左下、右上和右下
3. 编码表：
   0:<PAD>
   1:<SOS>
   2:<EOS>
   3:<SOBS>
   4:<EOBS>
   5:<SONS>
   6:<EONS>
   7:<SODPS>
   8:<EODPS>
   9:<SEP>
   10:<SEPN>
   11:<SEPND>
   12->12+pcb_size-1:PCB板子内部的位置编码
   12+pcb_size-1+1:PCB板子轮廓大小的编码
   12+pcb_size-1+2->12+pcb_size-1+2+pcb_size-2:主器件和子器件轮廓大小的编码
   12+pcb_size-1+2+pcb_size-2+1->12+pcb_size-1+2+pcb_size-2+1+8-1:布线方向信息的编码

   输入到模型的数据结构见 ## 任务技术方案 的小4，其中<SOS>表示整个序列的起始符；<SOBS>表示pcb板
   子和主器件信息的起始符；PCB板子的轮廓大小和主器件轮廓大小可以在编码表中查找；<EOBS>表示pcb板
   子和主器件信息的终止符；<SEP>表示不同信息之间的分隔符；<SONS>表示net信息的起始符；主器件pin
   脚的位置编码和子器件的轮廓大小可以在编码表中查找；<SEPN>表示不同net的分隔符；<EONS>表示net信
   息的终止符；<SODPS>表示布线路径信息和子器件位置信息的起始符；布线路径信息和子器件的左下角的位置编码可以
   查找编码表；<SEPDP>表示不同net的布线路径信息以及子器件位置预测信息的分隔符；<EODPS>表示布线路
   径信息和子器件位置信息的终止符；<EOS>表示整个序列的终止符；<PAD>将所有数据padding到同一长度便
   于训练
4. 数据集的产生：
   a. PCB板建模：将PCB板按照板子的大小划分成30x30的网格，主器件的左下角的位置位于网格点上，主器件和子器件
      的轮廓位于网格线上，主器件和子器件的pin脚位置在
      范围1为：x坐标范围为器件左边界x坐标到器件右边界坐标-1，y坐标为器件下边界坐标+1；
      范围2为：x坐标为器件右边界y坐标-1，y坐标范围为器件下边界坐标+1到器件上边界坐标；
      范围3为：x坐标范围为器件左边界x坐标到器件右边界坐标-1，y坐标为器件上边界坐标；
      范围4为：x坐标为器件左边界坐标，y坐标范围为器件下边界坐标+1到器件上边界坐标；
      确保pin脚不会超出器件的轮廓
   b. PCB器件布线准则：
      布线连接主器件和子器件之间的pin脚，有左、右、上、下、左上、左下、右上和右下八个方向；
      线的路径由A*算法产生，要保证所有线路径无重叠和交叉。
   c. PCB器件布局准则：
      主器件在PCB网格上随机产生位置；
      子器件位置在主器件周围产生，距离主器件位置不可过近或过远，子器件有一个pin脚和主器件相连，为布线信息；
      器件之间不可重叠，pin脚连接关系的飞线不可以交叉，以保证布线的效率；
      子器件之间的排布要有规律，在同一行或同一列排布，一行或一列排不下时可以排多列，但是要整齐美观；
   d. 制备数据集：在确定主器件轮廓、子器件轮廓、主器件位置、主器件和子器件pin脚连接关系并完成布线后，
      按照json格式存储布局和布线信息：
      {pcb1:{comp_info:{main:{pos:[x, y], contour:[x_contour, y_contour], pin:{pin1:[与器件左下角的相对位置], pin2:...}},
                       {sub1:{pos:[x, y], 轮廓大小:[x_contour, y_contour], pin:{pin1:[与器件左下角的相对位置], pin2:...}},
                       ......
            {net_info:{net1:{主器件名:pin脚名, 子器件名:pin脚名}, net2:{主器件名:pin脚名, 子器件名:pin脚名}}，
                       net2......}}
   e. 数据token化：按照数据集中的net_info以及编码表中的编码方式，使用dataloader将数据构造成符合数据格式要求的数据
5. 训练与测试：
   划分训练集与测试集，使用进度条创建训练进程；
   训练阶段利用前n-1个token与后n-1个token计算损失完成训练，固定轮次进行训练效果的验证；
   测试阶段将<SOS>到<SODPS>的编码作为提示信息输入到模型，模型预测<第一个net的布线路径信息>到<第n个net子器件的左下角的位置编码>
6. 可视化:
   第一个可视化为原始数据集的可视化，根据原始数据集便能绘制出布局和布线效果图；
   第二个可视化为基于token数据格式的可视化，根据预测出的token编码绘制出布局和布线图

